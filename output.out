Using device: cudaUsing device: cuda

Using device: cuda
Using device: cuda

***** Training bert-base-uncased *****

***** Training bert-base-uncased *****

***** Training bert-base-uncased *****

***** Training bert-base-uncased *****
Enabled gradient checkpointing for bert-base-uncased
Enabled gradient checkpointing for bert-base-uncased
Enabled gradient checkpointing for bert-base-uncased
Enabled gradient checkpointing for bert-base-uncased
wizard29:1657502:1657502 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657502:1657502 [0] NCCL INFO Bootstrap : Using enp129s0:10.5.18.29<0>
wizard29:1657502:1657502 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
wizard29:1657502:1657502 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
wizard29:1657502:1657502 [0] NCCL INFO NET/Plugin: Using internal network plugin.
wizard29:1657502:1657502 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
wizard29:1657504:1657504 [2] NCCL INFO cudaDriverVersion 12040
wizard29:1657504:1657504 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657504:1657504 [2] NCCL INFO Bootstrap : Using enp129s0:10.5.18.29<0>
wizard29:1657503:1657503 [1] NCCL INFO cudaDriverVersion 12040
wizard29:1657503:1657503 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657505:1657505 [3] NCCL INFO cudaDriverVersion 12040
wizard29:1657503:1657503 [1] NCCL INFO Bootstrap : Using enp129s0:10.5.18.29<0>
wizard29:1657505:1657505 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657505:1657505 [3] NCCL INFO Bootstrap : Using enp129s0:10.5.18.29<0>
wizard29:1657504:1657504 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
wizard29:1657504:1657504 [2] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
wizard29:1657504:1657504 [2] NCCL INFO NET/Plugin: Using internal network plugin.
wizard29:1657503:1657503 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
wizard29:1657503:1657503 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
wizard29:1657503:1657503 [1] NCCL INFO NET/Plugin: Using internal network plugin.
wizard29:1657505:1657505 [3] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
wizard29:1657505:1657505 [3] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
wizard29:1657505:1657505 [3] NCCL INFO NET/Plugin: Using internal network plugin.
wizard29:1657502:1658650 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657503:1658653 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657504:1658651 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657505:1658652 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker0
wizard29:1657505:1658652 [3] NCCL INFO NET/IB : Using [0]mlx4_0:1/RoCE [RO]; OOB enp129s0:10.5.18.29<0>
wizard29:1657505:1658652 [3] NCCL INFO Using non-device net plugin version 0
wizard29:1657505:1658652 [3] NCCL INFO Using network IB
wizard29:1657503:1658653 [1] NCCL INFO NET/IB : Using [0]mlx4_0:1/RoCE [RO]; OOB enp129s0:10.5.18.29<0>
wizard29:1657503:1658653 [1] NCCL INFO Using non-device net plugin version 0
wizard29:1657503:1658653 [1] NCCL INFO Using network IB
wizard29:1657504:1658651 [2] NCCL INFO NET/IB : Using [0]mlx4_0:1/RoCE [RO]; OOB enp129s0:10.5.18.29<0>
wizard29:1657504:1658651 [2] NCCL INFO Using non-device net plugin version 0
wizard29:1657504:1658651 [2] NCCL INFO Using network IB
wizard29:1657502:1658650 [0] NCCL INFO NET/IB : Using [0]mlx4_0:1/RoCE [RO]; OOB enp129s0:10.5.18.29<0>
wizard29:1657502:1658650 [0] NCCL INFO Using non-device net plugin version 0
wizard29:1657502:1658650 [0] NCCL INFO Using network IB
wizard29:1657503:1658653 [1] NCCL INFO ncclCommInitRank comm 0xbf58e40 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 3b000 commId 0xb80eb64cef3baaf7 - Init START
wizard29:1657504:1658651 [2] NCCL INFO ncclCommInitRank comm 0xab70770 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 86000 commId 0xb80eb64cef3baaf7 - Init START
wizard29:1657502:1658650 [0] NCCL INFO ncclCommInitRank comm 0xec93770 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 18000 commId 0xb80eb64cef3baaf7 - Init START
wizard29:1657505:1658652 [3] NCCL INFO ncclCommInitRank comm 0xd522880 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId af000 commId 0xb80eb64cef3baaf7 - Init START
wizard29:1657503:1658653 [1] NCCL INFO Setting affinity for GPU 1 to ffff
wizard29:1657504:1658651 [2] NCCL INFO Setting affinity for GPU 2 to ffff0000
wizard29:1657504:1658651 [2] NCCL INFO NVLS multicast support is not available on dev 2
wizard29:1657503:1658653 [1] NCCL INFO NVLS multicast support is not available on dev 1
wizard29:1657502:1658650 [0] NCCL INFO Setting affinity for GPU 0 to ffff
wizard29:1657502:1658650 [0] NCCL INFO NVLS multicast support is not available on dev 0
wizard29:1657505:1658652 [3] NCCL INFO Setting affinity for GPU 3 to ffff0000
wizard29:1657505:1658652 [3] NCCL INFO NVLS multicast support is not available on dev 3
wizard29:1657504:1658651 [2] NCCL INFO comm 0xab70770 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
wizard29:1657502:1658650 [0] NCCL INFO comm 0xec93770 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
wizard29:1657503:1658653 [1] NCCL INFO comm 0xbf58e40 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
wizard29:1657505:1658652 [3] NCCL INFO comm 0xd522880 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
wizard29:1657504:1658651 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
wizard29:1657504:1658651 [2] NCCL INFO P2P Chunksize set to 131072
wizard29:1657502:1658650 [0] NCCL INFO Channel 00/02 :    0   1   2   3
wizard29:1657502:1658650 [0] NCCL INFO Channel 01/02 :    0   1   2   3
wizard29:1657502:1658650 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
wizard29:1657502:1658650 [0] NCCL INFO P2P Chunksize set to 131072
wizard29:1657505:1658652 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
wizard29:1657505:1658652 [3] NCCL INFO P2P Chunksize set to 131072
wizard29:1657503:1658653 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
wizard29:1657503:1658653 [1] NCCL INFO P2P Chunksize set to 131072
wizard29:1657504:1658651 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
wizard29:1657504:1658651 [2] NCCL INFO Channel 01 : 2[2] -> 3[3] via SHM/direct/direct
wizard29:1657502:1658650 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
wizard29:1657505:1658652 [3] NCCL INFO Channel 00 : 3[3] -> 0[0] via SHM/direct/direct
wizard29:1657503:1658653 [1] NCCL INFO Channel 00 : 1[1] -> 2[2] via SHM/direct/direct
wizard29:1657502:1658650 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
wizard29:1657505:1658652 [3] NCCL INFO Channel 01 : 3[3] -> 0[0] via SHM/direct/direct
wizard29:1657503:1658653 [1] NCCL INFO Channel 01 : 1[1] -> 2[2] via SHM/direct/direct
wizard29:1657502:1658650 [0] NCCL INFO Connected all rings
wizard29:1657503:1658653 [1] NCCL INFO Connected all rings
wizard29:1657504:1658651 [2] NCCL INFO Connected all rings
wizard29:1657505:1658652 [3] NCCL INFO Connected all rings
wizard29:1657505:1658652 [3] NCCL INFO Channel 00 : 3[3] -> 2[2] via SHM/direct/direct
wizard29:1657505:1658652 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
wizard29:1657504:1658651 [2] NCCL INFO Channel 00 : 2[2] -> 1[1] via SHM/direct/direct
wizard29:1657504:1658651 [2] NCCL INFO Channel 01 : 2[2] -> 1[1] via SHM/direct/direct
wizard29:1657503:1658653 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
wizard29:1657503:1658653 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
wizard29:1657502:1658650 [0] NCCL INFO Connected all trees
wizard29:1657505:1658652 [3] NCCL INFO Connected all trees
wizard29:1657502:1658650 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
wizard29:1657503:1658653 [1] NCCL INFO Connected all trees
wizard29:1657502:1658650 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
wizard29:1657505:1658652 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
wizard29:1657505:1658652 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
wizard29:1657503:1658653 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
wizard29:1657504:1658651 [2] NCCL INFO Connected all trees
wizard29:1657503:1658653 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
wizard29:1657504:1658651 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
wizard29:1657504:1658651 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
wizard29:1657504:1658651 [2] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
wizard29:1657504:1658651 [2] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
wizard29:1657504:1658651 [2] NCCL INFO ncclCommInitRank comm 0xab70770 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 86000 commId 0xb80eb64cef3baaf7 - Init COMPLETE
wizard29:1657505:1658652 [3] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
wizard29:1657502:1658650 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
wizard29:1657503:1658653 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
wizard29:1657505:1658652 [3] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
wizard29:1657502:1658650 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
wizard29:1657503:1658653 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
wizard29:1657505:1658652 [3] NCCL INFO ncclCommInitRank comm 0xd522880 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId af000 commId 0xb80eb64cef3baaf7 - Init COMPLETE
wizard29:1657502:1658650 [0] NCCL INFO ncclCommInitRank comm 0xec93770 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 18000 commId 0xb80eb64cef3baaf7 - Init COMPLETE
wizard29:1657503:1658653 [1] NCCL INFO ncclCommInitRank comm 0xbf58e40 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 3b000 commId 0xb80eb64cef3baaf7 - Init COMPLETE
wizard29:1657503:1658662 [1] NCCL INFO [Service thread] Connection closed by localRank 1
wizard29:1657502:1658659 [0] NCCL INFO [Service thread] Connection closed by localRank 0
wizard29:1657504:1658658 [2] NCCL INFO [Service thread] Connection closed by localRank 2
wizard29:1657505:1658663 [3] NCCL INFO [Service thread] Connection closed by localRank 3
wizard29:1657503:1659402 [1] NCCL INFO comm 0xbf58e40 rank 1 nranks 4 cudaDev 1 busId 3b000 - Abort COMPLETE
wizard29:1657502:1659403 [0] NCCL INFO comm 0xec93770 rank 0 nranks 4 cudaDev 0 busId 18000 - Abort COMPLETE
wizard29:1657504:1659404 [2] NCCL INFO comm 0xab70770 rank 2 nranks 4 cudaDev 2 busId 86000 - Abort COMPLETE
wizard29:1657505:1659405 [3] NCCL INFO comm 0xd522880 rank 3 nranks 4 cudaDev 3 busId af000 - Abort COMPLETE
